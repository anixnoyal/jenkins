#!/bin/bash

# Create a target group
target_group_arn=$(aws elbv2 create-target-group \
    --name my-target-group \
    --protocol HTTP \
    --port 8443 \
    --vpc-id vpc-12345678 \
    --matcher "HttpCode=200,PathPattern=/my-path-pattern/*" \
    --target-type instance \
    --query 'TargetGroups[0].TargetGroupArn' \
    --output text)

# Register an instance to the target group
aws elbv2 register-targets \
    --target-group-arn "$target_group_arn" \
    --targets Id=i-1234567890abcdef0

echo "Target group created and instance registered."
